# 评估

# 第一章

1.  正确答案:(二)假。基于一个架构的容器不能在不同的架构上运行。例如，使用 x86 体系结构创建的映像将无法在基于 ARM 的体系结构上运行。
2.  正确答案:(D)联合文件系统。Docker 使用 Union 文件系统来管理多个映像层。这些层从上到下读取，以提供单个文件系统的外观。
3.  正确答案:(D)重叠 2。运行 4.0 或更高版本内核的系统将使用 Overlay2 存储驱动程序。
4.  正确答案:(C)容器层。对正在运行的容器的文件系统所做的任何更改都存储在最顶层，称为容器层。
5.  正确答案:(C) `docker exec -it <container> /bin/bash`。`docker exec`命令用于执行容器中的进程。使用`-it`选项告诉 exec 命令使用交互式终端来执行。您想要执行的进程是最后一个参数，由于我们想要访问容器的 Bash shell，所以我们正在执行`/bin/bash`。
6.  正确答案:(二)假。当您停止正在运行的容器时，守护程序将只停止正在运行的映像。容器层将保留在主机的文件系统上。如果要删除容器，必须使用`docker rm`命令从守护程序中删除容器。
7.  正确答案:(B) `docker ps -a`。要查看所有正在运行和已停止的容器列表，请使用`docker ps -a`命令。如果您使用`-all`或`-list`，守护程序会将该选项解释为`-l`，它只会列出最新的容器。列出最新的容器将排除已停止较长时间的容器。

# 第二章

1.  正确答案:(二)绑定挂载和(三)卷。只有 Docker 卷和绑定装载为容器提供持久性。tmpfs 卷存储在 RAM 中，不会写入磁盘。
2.  正确答案:(一)正确。必须先创建一个卷，然后才能在容器中使用。如果在运行容器之前没有创建卷，Docker 将在将其装入容器之前创建卷。
3.  正确答案:(D) 32 GB。如果没有指定 tmpfs 大小，Docker 将创建一个等于主机 RAM 一半的卷。
4.  正确答案:(二)假。默认情况下，停止或删除映像不会删除永久卷。要删除卷，您可以在`docker rm`命令中添加`-v`选项，或者使用`docker volume rm`命令手动删除卷。
5.  正确答案:(二)命名卷。Docker 守护程序仅管理匿名和命名卷。
6.  正确答案:(D)您必须手动删除绑定文件夹。由于绑定装载不由 Docker 管理，守护程序无法删除未使用的卷。要删除绑定装载，您需要手动删除绑定装载使用的目录。

# 第三章

1.  正确答案:(二)假。Docker 分配的默认桥有局限性。如果您计划在主机上运行多个容器，则创建自定义网桥网络被认为是最佳做法。
2.  正确答案:(C) `192.168.100.10:80`。套接字是 IP 地址和端口的组合。`192.168.100.10:80`是在端口`80`上运行服务的服务器的套接字，其 IP 地址为`192.168.100.10`。
3.  正确答案:(C) `docker run -p 8081:8080 -d nginx-web bitnami/nginx`。由于主机已经将端口`8080`绑定到另一个服务，我们无法使用`8080:8080`启动新的容器。由于每个 Docker 容器都有自己的 IP 地址，所以我们仍然可以对容器使用端口`8080`，但是传入的主机端口分配必须使用一个未使用的端口。唯一正确的答案是 C，因为它将主机的端口`8081`绑定到在端口`8080`上运行的容器端口。
4.  正确答案:(D) `docker run --network=none -it badimage bash`。如果您在没有提供任何网络选项的情况下启动一个容器，该容器将尝试在默认的 Docker 桥网络上运行。要在没有网络的情况下启动容器，您可以通过使用`–network=none`选项运行映像来将网络设置为无。
5.  正确答案:(二)假。能够动态改变连接的网络是定制网桥网络的一个特点。
6.  正确答案:(B) `65535`。IP 端口的有效端口范围是`1-65535`。

# 第四章

1.  正确答案:(三)持续卷。PersistentVolume 是使用 PersistentVolumeClaims 声明的–在创建 PersistentVolumeClaim 之前，PersistentVolume 必须存在。
2.  正确答案:(D)牧场主。KinD 包括由 Rancher 创建的本地路径提供程序。
3.  正确答案:(一)负载均衡器。当一个集群有多个工作节点时，您需要在集群前面安装一个负载平衡器，以便将流量定向到后端工作节点。
4.  正确答案:(二)假。如图*图 5.9* 所示，一个 Kubernetes 集群可以有多个 CSIDrivers。这允许集群连接到多个后端存储系统。

# 第五章

1.  正确答案:(D)入口控制器。入口控制器是用于公开服务的附加组件，它不是控制平面的一部分。
2.  **正确答案:(D) ETCD。ETCD 是 Kubernetes 用来存储所有对象及其状态的数据库。**
3.  **正确答案:(C)** `kube-scheduler`。`kube-scheduler` **在每个工作节点上使用来自** `kubelet` **的各种标准来调度工作负载。**
4.  **正确答案:(B)** `-v` **。** `-v` **选项启用** `kubectl` **命令的详细输出。**
5.  **正确答案:(D)** `NodePort` **。当您创建** `NodePort` **服务时，它将被分配一个位于** `30000-32767`之间的端口。每个节点都将更新服务和访问它的端口。由于每个节点都知道该服务，因此任何节点都可以为传入的请求提供服务。
6.  **正确答案:(一)** `StatefulSet` **。A** `StatefulSet` **将根据清单中指定的名称，创建每个具有已知名称的吊舱。每个吊舱都将收到一个名称，并附有一个数字。为了提供创建控制，当一个容器被创建时，它必须在下一个容器被创建之前完全部署。**

# 第六章

1.  正确答案:(D)通过选择器标签。创建服务对象时，您包括一个选择器，该选择器包含与服务端点相匹配的标签。任何匹配的吊舱都将被添加为端点。
2.  正确答案:(B) `kubectl get ep <service name>`。服务使用端点来选择接收服务请求的容器。对服务进行故障排除的第一步是验证端点是否已分配。
3.  正确答案:(二)假。有些发行版确实包含对`LoadBalancer`服务的开箱即用支持，但大多数仍然不包含不需要添加组件(如 MetalLB)的支持。
4.  正确答案:(D)第 4 层。Kubernetes 中使用的两个负载平衡器是第 7 层和第 4 层。第 7 层负载平衡器运行在现场视察模型的第 7 层，只能接受应用级流量，如 HTTP 和 HTTPS。由于第 4 层负载平衡器运行在现场视察模型的较低层，它们可以访问较低层的数据包，如直接传输控制协议和 UDP。
5.  正确答案:(A)`NodePort``ClusterIP`。基本Kubernetes集群不允许`LoadBalancer`类型使用多个协议。只有`ClusterIP`和`NodePort`可以创建一个同时定义了 UDP 和 TCP 协议的服务。

# 第七章

1.  正确答案:(一)正确。OpenID Connect 是 IETF 发布的标准:[https://openid.net/specs/openid-connect-core-1_0.html](https://openid.net/specs/openid-connect-core-1_0.html)。
2.  正确答案:(B) `id_token`。`id_token`包含关于用户身份的声明。`refresh_token`用来获得新的`id_token`。`access_token`用于与身份提供者进行交互。`certificate_token`不存在。
3.  正确答案:(C)当所有其他身份验证解决方案都不可用时，在紧急情况下打碎玻璃。请记住严格控制此证书和密钥对。
4.  正确答案:(D)不基于用户名的不可变 ID。这样，如果用户的名字发生了变化(这种情况比预期的更频繁)，他们的访问权限就不会改变。
5.  正确答案:(D)在 Kubernetes API 服务器可执行文件上设置为标志。如何设置标志将取决于您的分发，但最终，每个分发都会在 API 服务器的命令上设置这些标志。
6.  正确答案:(二)假。模拟用户未被授予默认组；也就是`system:authenticated`。反向代理需要添加该组。
7.  正确答案:(二)假。仪表板永远不应该有自己的特权。否则，任何可以连接到它的人都可以使用它。

# 第八章

1.  正确答案:(一)假。RBAC 是授权资源的首选方法。
2.  正确答案:(三)apiGroups，resources，动词。
3.  正确答案:(A) Kubernetes API 引用。这是一个非常有价值的工具，可以列出应用编程接口的每个网址。这可用于确定资源。
4.  正确答案:(B)定义一个集群角色，并在每个命名空间中将其引用为角色绑定。这样，每当引用集群角色时，对集群角色的更改都会得到反映。
5.  正确答案:(D)只要有可能，角色绑定和集群角色绑定应该引用组。直接引用用户是一种反模式，很难维护、审计和调试。
6.  正确答案:(二)假。RBAC 要求列举所有权利。
7.  正确答案:(二)假。还提供定制授权网络挂钩。

# 第九章

1.  正确答案:(一)假。仪表板和整个章节保持一致并不是天生不安全的；如何部署很重要。
2.  正确答案:(A)无身份验证，令牌，从反向代理注入。仪表板无法收集用户名、密码或第二因素。
3.  正确答案:(D)如果一个令牌被上传，它会被加密并作为 cookie 存储在浏览器中。仪表板不会在任何后端保存会话。
4.  正确答案:(D)以上都不是。仪表板不知道如何刷新令牌。
5.  正确答案:(四)反向代理背后。使用反向代理来管理登录过程、控制会话和添加多因素身份验证。
6.  正确答案:(二)假。仪表板的 2.0+版本支持模拟。
7.  正确答案:(二)假。如果配置正确，任何反向代理都可以。

# 第十章

1.  正确答案:(一)假。容器是一个进程，而不是虚拟机。
2.  正确答案:(B)如果标记为特权，则为是。特权容器可以像特权进程一样访问主机的资源。
3.  正确答案:(三)两者都有。攻击者会将多个漏洞串在一起，以获得对目标的访问权限。
4.  正确答案:(二)通过比较 Pod 的请求能力和通过 Pod 的创建者和它自己的`ServiceAccount`联盟授权的策略。无法显式设置策略。
5.  正确答案:(A)一个准入控制器，在创建时和更新时检查所有 Pods。策略执行不是由`PodSecurityPolicy` API 处理的，只是策略的定义。
6.  正确答案:(二)假。从确定替换、实现替换，到折旧过程，需要几年的时间。
7.  正确答案:(二)假。您不会在服务器上以 root 身份运行进程，所以不要在容器中运行。

# 第十一章

1.  正确答案:(二)假。gateway 是最初由微软在 OPA 之上构建的工具，但它们不是一回事。
2.  正确答案:(D)减压阀保存为`ConstraintTemplate`，是`GateKeeper`项目定义的`CustomResourceDefenition`。
3.  正确答案:(二)使用直接内置在 OPA 中的自动化框架。OPA 的自动化测试框架提供了一种在部署到 gateway 之前对减压阀进行预验证的强大方法。
4.  正确答案:(A)你不需要，因为减压阀会确定迭代步骤。在减压阀使用循环时，使用下划线来解析所有值，或者使用占位符(如 I 或 j)来解析数组索引。减压阀将通过迭代数组来填充计数器。
5.  正确答案:(C)在代码中添加跟踪函数，用`-v`运行`opa test`命令查看执行轨迹。`opa`会告诉你问题在哪里。使用其内置工具。
6.  正确答案:(二)假。约束模板可以包括使用与任何其他 CRD 相同的模式定义的参数。
7.  正确答案:(二)假。至少在写作的时候不是。网守还不能变异，所以需要建立额外的网络钩子来填补这个空白。

# 第十二章

1.  正确答案:(D) `falco_rules.local.yaml`。针对您的安装定制的任何规则更改都应保存在您的`falco_rules.changes.yaml`文件中。您不应该编辑包含规则集，它是`falco_rules.yaml`的一部分。`falco.yaml`文件是基本的 Falco 配置文件，不包含任何规则。
2.  正确答案:(二)答错了。有许多与 Kubernetes 兼容的转发器，但最常用的转发器之一是 FluentD。
3.  正确答案:(C)基巴纳。EFK 栈包括弹性搜索、FluentD 和 Kibana。Kibana 是为日志提供可视化和仪表板的组件。
4.  正确答案:(B) Falcosidekick。Falcosidekick 实用程序仅将 Falco 日志转发到中央日志服务器。
5.  正确答案:(一)列表。您可以使用列表对 Falco 中的项目集合进行分组。

# 第十三章

1.  正确答案:(一)正确。Velero 备份只能使用 S3 目标来存储备份。
2.  正确答案:(C)安装 MinIO，并在部署阶段将 NFS 卷用作永久磁盘。您可以安装 MinIO 并在部署中使用任何持久卷。MinIO 会将分配的存储呈现为 S3 存储桶，这与 MinIO 兼容。
3.  正确答案:(二)假。Velero 的功能之一是能够使用一个集群中的备份来恢复不同集群中的名称空间和对象。
4.  正确答案:(D) etcdctl。etcdctl 可以选择创建 ETCD 数据库的快照。
5.  正确答案:(D) `Velero create schedule daily-backup --schedule="0 3 * * *"`。此命令将创建每天凌晨 3 点运行的计划备份作业。schedule 命令接受一个名为`–schedule`的标签，它使用 cron 表达式。`0 3 * * *`是每天凌晨 3 点的 cron 表情。

# 第十四章

1.  正确答案:(一)假。这不是一个要求，但它肯定会让生活变得更容易！
2.  正确答案:(D)以上都不是。没有最小的步骤数。如何实现您的管道将取决于您自己的需求。
3.  正确答案:(C)使用 Git 作为操作配置的权威来源。您不是直接与 Kubernetes API 交互，而是将对象存储在 Git 存储库中，让控制器保持它们的同步。
4.  正确答案:(B)没有标准；每个项目和供应商都有自己的实现。在这一章中，我们使用了 Tekton，它是 YAML、容器和 shell 脚本的组合。Amazon、Azure 和 GitHub 都将其管道脚本存储在应用源中。对你写的东西没有要求。
5.  正确答案:(B)更新 Git 中的`Deployment`或`StatefulSet`清单，让 GitOps 控制器更新 Kubernetes 中的对象。目标是最大限度地减少 kubectl 的使用，并维护 Git 中的更改日志。
6.  正确答案:(二)假。这几乎是不可能的。操作员模型，其中自定义控制器基于自定义资源创建对象，几乎永远不会与这个假设一起工作。至少现在还没有。一旦您部署了示例，您将看到 Tekton 创建了 Git 中没有的对象。机密是其他可能也不应该存在于 Git 中的对象。
7.  正确答案:(一)正确。Kubernetes 是一个搭建平台的平台。虽然肯定有常见的模式和最佳实践，但说到做到，Kubernetes 的强大之处在于它为您提供了以最适合您的方式自动化系统的灵活性。